<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="514px" preserveAspectRatio="none" style="width:576px;height:514px;background:#FFFFFF;" version="1.1" viewBox="0 0 576 514" width="576px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="450" x="56.5" y="17.4023">Console and Nexus auth architecture (browser only)</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="0" x="284.5" y="38.6016"/><!--MD5=[8699c0c8e953ee53654a072cc875bfb4]
cluster Browser--><rect fill="#FFFFFF" height="113" style="stroke:#000000;stroke-width:1.5;" width="205" x="169" y="49.3984"/><path d="M237,49.3984 L237,58.8867 L227,68.8867 L169,68.8867 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="58" x="172" y="63.9336">Browser</text><!--MD5=[ce422f5af7fd8dd73624d67d10d91b86]
cluster CockroachDB--><path d="M273,359.3984 C273,349.3984 421,349.3984 421,349.3984 C421,349.3984 569,349.3984 569,359.3984 L569,443.3984 C569,453.3984 421,453.3984 421,453.3984 C421,453.3984 273,453.3984 273,443.3984 L273,359.3984 " fill="#F6FDFA" style="stroke:#23684A;stroke-width:1.5;"/><path d="M273,359.3984 C273,369.3984 421,369.3984 421,369.3984 C421,369.3984 569,369.3984 569,359.3984 " fill="none" style="stroke:#23684A;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="94" x="374" y="384.9336">CockroachDB</text><!--MD5=[df0a7dcd11e8ea00adaa3415db5625da]
entity Console client--><polygon fill="#F6FDFA" points="212.5,102.3984,222.5,92.3984,349.5,92.3984,349.5,128.8867,339.5,138.8867,212.5,138.8867,212.5,102.3984" style="stroke:#23684A;stroke-width:1.5;"/><line style="stroke:#23684A;stroke-width:1.5;" x1="339.5" x2="349.5" y1="102.3984" y2="92.3984"/><line style="stroke:#23684A;stroke-width:1.5;" x1="212.5" x2="339.5" y1="102.3984" y2="102.3984"/><line style="stroke:#23684A;stroke-width:1.5;" x1="339.5" x2="339.5" y1="102.3984" y2="138.8867"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="227.5" y="125.9336">Console client</text><!--MD5=[3ae1ea672d585a3b4c0564b6a9fdaad8]
entity instances, etc.--><rect fill="#FFFFFF" height="22.4883" style="stroke:#23684A;stroke-width:1.5;" width="116" x="429" y="407.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="439" y="423.9336">instances, etc.</text><!--MD5=[853f148258f3492b777f181caf578766]
entity sessions--><rect fill="#FFFFFF" height="22.4883" style="stroke:#23684A;stroke-width:1.5;" width="78" x="316" y="407.3984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="326" y="423.9336">sessions</text><!--MD5=[3337be62b4085cbd88469065495fef9c]
entity Nexus--><polygon fill="#F6FDFA" points="239.5,258.3984,249.5,248.3984,322.5,248.3984,322.5,284.8867,312.5,294.8867,239.5,294.8867,239.5,258.3984" style="stroke:#23684A;stroke-width:1.5;"/><line style="stroke:#23684A;stroke-width:1.5;" x1="312.5" x2="322.5" y1="258.3984" y2="248.3984"/><line style="stroke:#23684A;stroke-width:1.5;" x1="239.5" x2="312.5" y1="258.3984" y2="258.3984"/><line style="stroke:#23684A;stroke-width:1.5;" x1="312.5" x2="312.5" y1="258.3984" y2="294.8867"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="254.5" y="281.9336">Nexus</text><!--MD5=[9745541e185686159345f6790998d19a]
entity 3p--><polygon fill="#F6FDFA" points="16,258.3984,26,248.3984,204,248.3984,204,284.8867,194,294.8867,16,294.8867,16,258.3984" style="stroke:#23684A;stroke-width:1.5;"/><line style="stroke:#23684A;stroke-width:1.5;" x1="194" x2="204" y1="258.3984" y2="248.3984"/><line style="stroke:#23684A;stroke-width:1.5;" x1="16" x2="194" y1="258.3984" y2="258.3984"/><line style="stroke:#23684A;stroke-width:1.5;" x1="194" x2="194" y1="258.3984" y2="294.8867"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="31" y="281.9336">3rd-party auth server</text><!--MD5=[1d90e5416406825339fb247c430603d5]
link Console client to Nexus--><path d="M281,138.4584 C281,166.0184 281,213.1784 281,243.0184 " fill="none" id="Console client-to-Nexus" style="stroke:#23684A;stroke-width:1.0;"/><polygon fill="#23684A" points="281,248.3784,285,239.3784,281,243.3784,277,239.3784,281,248.3784" style="stroke:#23684A;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="282" y="199.9668">Console pages, assets,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="296" y="215.2773">API calls, sessions</text><!--MD5=[7f95df7bbd74a28c681e88d0afc27d7a]
link Browser to 3p--><path d="M168.8289,121.9982 C168.7546,122.0519 168.6798,122.106 168.6047,122.1604 C168.3043,122.378 167.9976,122.6013 167.6847,122.8303 C162.6787,126.4941 156.1137,131.6034 149.155,137.8459 C135.2375,150.3309 119.745,167.3484 112,186.3984 C104.73,204.2784 104.44,226.1184 105.86,243.0384 " fill="none" id="Browser-to-3p" style="stroke:#23684A;stroke-width:1.0;"/><polygon fill="#23684A" points="106.35,248.1284,109.4559,238.7821,105.8638,243.1521,101.4938,239.56,106.35,248.1284" style="stroke:#23684A;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="113" y="207.4668">Auth</text><!--MD5=[d5639a92ef2960c799905e3e6fbbd28c]
reverse link Browser to Nexus--><path d="M189.468,162.5572 C189.5063,162.6637 189.5448,162.7702 189.5833,162.8767 C189.6604,163.0897 189.7378,163.3026 189.8155,163.5154 C190.4375,165.2177 191.0813,166.9141 191.7469,168.5942 C193.0781,171.9544 194.4963,175.2497 196,178.3984 C205.24,197.7484 208.91,202.2284 223,218.3984 C232.24,228.9984 243.55,239.5684 253.71,248.3884 " fill="none" id="Browser-backto-Nexus" style="stroke:#23684A;stroke-width:1.0;"/><polygon fill="#23684A" points="189.468,162.5572,188.754,172.3802,191.1621,167.2615,196.2808,169.6696,189.468,162.5572" style="stroke:#23684A;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="233" y="199.9668">Auth</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="224" y="215.2773">redirect</text><!--MD5=[833d1d56859def128e94e82751770b4a]
link Nexus to CockroachDB--><path d="M281,294.4184 C281,304.4009 281,316.9178 281,330.1172 C281,333.417 281,336.7595 281,340.1158 C281,341.7939 281,343.4754 281,345.1568 C281,345.9974 281,346.8381 281,347.6782 C281,348.0983 281,348.5182 281,348.938 " fill="none" id="Nexus-to-CockroachDB" style="stroke:#23684A;stroke-width:1.0;"/><polygon fill="#23684A" points="281,348.938,285,339.938,281,343.938,277,339.938,281,348.938" style="stroke:#23684A;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="283.5" y="472.9336"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="37" x="30.5" y="489.4219">Note:</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="461" x="71.5" y="489.4219">Browser is distinguished from console client because auth redirects</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="430" x="66.5" y="505.9102">go app server &gt; browser &gt; auth server, skipping console client</text><!--MD5=[d2d821e44eebd45ed9eac1684816ae40]
@startuml architecture-browser-only

!includesub theme.pml!COLORS
!includesub theme.pml!COMMON
!includesub theme.pml!SEQUENCE

skinparam CardBackgroundColor white

title "Console and Nexus auth architecture (browser only)\n"

caption "\n<b>Note:</b> Browser is distinguished from console client because auth redirects\ngo app server > browser > auth server, skipping console client"

frame Browser {
  node "Console client"
}

node Nexus
 
node 3p as "3rd-party auth server"

database CockroachDB {
    card "instances, etc."
    card sessions
}

[Console client] - -> Nexus : "Console pages, assets,\nAPI calls, sessions"
Browser - -> 3p : "Auth"

[Nexus] -u-> Browser : "Auth\nredirect"

[Nexus] - -> CockroachDB

@enduml

@startuml architecture-browser-only


skinparam shadowing false
skinparam ArrowColor #23684A

skinparam ActorBackgroundColor #F6FDFA
skinparam ActorBorderColor #23684A

skinparam NodeBackgroundColor #F6FDFA
skinparam NodeBorderColor #23684A

skinparam CardBackgroundColor #F6FDFA
skinparam CardBorderColor #23684A
skinparam DatabaseBackgroundColor #F6FDFA
skinparam DatabaseBorderColor #23684A

skinparam NoteBackgroundColor #D1F5E5
skinparam NoteBorderColor #23684A

skinparam sequence {
  ParticipantBackgroundColor #23684A
  ParticipantBackgroundColor #F6FDFA
  ParticipantBorderColor #23684A

  LifeLineBorderColor #23684A
}


skinparam CardBackgroundColor white

title "Console and Nexus auth architecture (browser only)\n"

caption "\n<b>Note:</b> Browser is distinguished from console client because auth redirects\ngo app server > browser > auth server, skipping console client"

frame Browser {
  node "Console client"
}

node Nexus
 
node 3p as "3rd-party auth server"

database CockroachDB {
    card "instances, etc."
    card sessions
}

[Console client] - -> Nexus : "Console pages, assets,\nAPI calls, sessions"
Browser - -> 3p : "Auth"

[Nexus] -u-> Browser : "Auth\nredirect"

[Nexus] - -> CockroachDB

@enduml

PlantUML version 1.2021.10(Mon Aug 30 08:43:48 CDT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>